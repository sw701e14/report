\section{Overview}
To ease the maintenance and ensure scalability, we have structured the project in an architecture which supports this.
The architecture consists of four macro components and a database, as can be seen in \cref{fig:architecture}. The macro components are: Shared, Location Service, Model Agent, and Web Service.\alexander{Maybe change the component name of `Model Updater' so it does not conflict with the layer name? \alexander{Changed name of component to `Model Agent'.}}

%\begin{figure}[h]
%\center
%\input{content/architecture_diagram.tex}
%\caption{The architecture of the system}
%\label{arch}
%\end{figure}

\begin{figure}[H]
\includegraphics[width=\textwidth, trim={0 8.5cm 8cm 0}]{systemArchitecture.pdf}
\caption{The architecture of the system}
\label{fig:architecture}
\end{figure}

\subsection*{Database} The database used is a MySQL database, and is where all our data is stored.
\alexander{Reference to \cref{database_design}?}


\subsection*{Shared}\texttt{Shared} is the macro component containing the \texttt{Data Access} layer and the \texttt{Data Transfer Object} layer.
The macro component's task is to provide extended capabilities to all other macro components.

\paragraph{The Data Access layer} provides communication with the database.
All (SQL statements)/communication are encapsulated here providing the upper layers methods to communicate with the database.\alexander{Are `SQL statements' too implementation-specific?}

\paragraph{The Data Transfer Object layer} contains all the shared data types and their attributes.
Using the \texttt{Data Transfer Object (DTO)} layer, data can be transfered between the \texttt{Web Service}, other macro components, and clients without several different data requests.


\subsection*{Location Service}\texttt{Location Service} is the macro component containing the \texttt{Common} layer, the \texttt{Location Source} layer, and the \texttt{Data Collector} layer.
The macro component's task is to process and store location data directly from the data source. It is structured so the \texttt{Location Source} layer can easily be replaced.\alexander{Reference to simulation section?}

\paragraph{The Common layer} encapsulates and describes the fetched data, making it easier for the \texttt{Location Source} layer and \texttt{Data Collector} layer to process.

\paragraph{The Location Source layer} fetched data from the data source then adapts and casts the data to the appropriate data type in the \texttt{Common} layer.

\paragraph{The Data Collector layer} gathers the data from the \texttt{Location Source} layer and processes it according to the standards of the \texttt{Data Transfer Object} layer. The data is then stored through the \texttt{Data Access} layer.


\subsection*{Model Agent\footnote{An agent is defined as a program that invoke a given task, when a condition is satisfied, then returning to a sleeping state, until the condition is satisfied again.\cite{definitionagent}}}\texttt{Model Agent} is the macro component containing the \texttt{Model Updater} layer.
The macro component's task is to generate and update the model in the system, i.e. Markov chains.

\paragraph{The Model Updater layer} handles the calculation and generation of the models.
\alexander{Reference to \cref{sec:generatemarkov}?}

\subsection*{Web Service}\label{arch:webservice}
\texttt{Web Service} is the macro component containing the \texttt{Model}, \texttt{View}, and \texttt{Controller}.
The macro component's task to provide a web service for public use.\alexander{Reference to Web Service chapter?}

\paragraph{The Model} manages the application domain and handles data and actions possible for each data type.

\paragraph{The View} manages the display of the \texttt{Model}.

\paragraph{The Controller} handles the user interaction. Based on the user request, the \texttt{Controller} sends commands to the \texttt{Model} and \texttt{View}.