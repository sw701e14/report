\section{Generating the Model}\label{sec:generatemarkov}
The Markov chain $\mathcal{M}$, described in \Cref{markov}, is generated by the steps detailed in this section.
The algorithm takes a set of hotspots $H$ and a set of GPS data $G$, where $g \in G$ represents a single bike location update. For each hotspot $h \in H$ there exists a departure state $D_h$.
The result of the algorithm is a matrix with the probabilities for all possible transactions.

\begin{algorithm}[H]
\SetAlgoNoEnd
\textbf{CreateModel($H, G$)} \\
Let $M$ be an empty $n \times n$ matrix with $n = 2|H|$ \\
Let $G'$ be a grouping of $G$, so that for each $g_{b_i} \in G'$ we have the location for bike $b$ at time $i$\\
Let $S$ be a set of states, so that for each $s_{b_i} \in S$ we have the $G' \rightarrow S$ calculated state for bike $b$ in time-step $i$\\
Let $L$ be a set, so that each $l_b \in L$ is the latest state of bike $b$, initialized with its latest hotspot\\
\ForEach{$s_{b_i} \in S$}
    {\If{$L_b \in H \land s_{b_i} \not\in H$}{$n \leftarrow D_{t_{b_i}}$}
    \Else{$n \leftarrow t_{b_i}$}
    Transition $L_b \rightarrow n$ is added to $M$\\
     $L_b \leftarrow n$}
Normalize $M$\\
\Return{M}
\caption{Creating the model.}
\label{markov:create_model}
\end{algorithm}