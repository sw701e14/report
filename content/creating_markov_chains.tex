\section{Generating the Model}\label{sec:generatemarkov}
The Markov chain $\mathcal{M}$, described in \cref{markov}, is generated by the steps detailed in this section.
The algorithm takes a set of hotspots $H$ and a set of GPS data $G$. For each hotspot $H_i$ there exists a departure state $D_i$.
The result of the algorithm is a matrix with the probabilities for all possible transactions.

\begin{algorithm}[H]
\textbf{create\_model($H, G$)} \\
Let $M$ be an empty $n \times n$ matrix with $n = 2|H|$ \\
Let $G'$ be a grouping of $G$, so that for each $G'_i \in G'$ we have all bike states for state $i$\\
Let $I$ be a set of the latest state for each bike, determined by its latest location\\
\For{each grouped state $s$ in $G'$}
  {\For{each bike $b$ in $s$}
    {\If{$s'$ is a hotspot and $s$ is not}{$s =$ the departure state of $s$}The transition $s' \rightarrow s$ is added to $M$\\
     $s' = s$}}
$M$ is normalized.\\
\Return{M}
\caption{Creating the model.}
\label{markov:create_model}
\end{algorithm}